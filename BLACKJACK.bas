10 PRINT "DO YOU WANT INSTRUCTIONS? (IF SO, TYPE 1)"
15 INPUT K
25 IF K <> 1 THEN 85
30 PRINT
50 PRINT "THIS IS A GAME OF BLACKJACK - LAS VEGAS STYLE."
55 PRINT "HERE ARE THE RULES OF THE HOUSE. THE DEALER"
60 PRINT "MUST HIT ON 16 OR LESS AND MUST STAY ON 17 OR"
65 PRINT "MORE. YOU MAY SPLIT TWO CARDS IF THEY ARE THE"
70 PRINT "SAME AND PLAY ONE HAND WITH EACH OF THEM. ALSO,"
75 PRINT "YOU MAY DOUBLE YOUR BET AND RECEIVE EXACTLY ONE"
80 PRINT "MORE CARD ANY TIME ON YOUR FIRST HIT."
85 PRINT "INSTRUCTIONS ARE: 0-NO HIT, 1-HIT, 2-DOUBLE, 3-SPLIT A PAIR."
95 IF K <> 1 THEN 155
100 PRINT "WHEN THE DEALER HAS AN EXPOSED ACE, HE WILL ASK"
105 PRINT "YOU FOR AN INSURANCE BET. AN INSURANCE BET WILL"
110 PRINT "RISK HALF YOUR BET FOR AN AMOUNT EQUAL TO YOUR BET"
115 PRINT "IF THE DEALER HAS BLACKJACK. YOU WIN IF HE DOES, AND"
120 PRINT "LOSE IF HE DOESN'T. THE HOUSE LIMIT IS $500."
125 PRINT "GOOD LUCK! THE DEALER IS KNOWN FOR DEALING FROM"
130 PRINT "THE BOTTOM OF THE DECK, SO WATCH HIM CAREFULLY!"
135 PRINT
155 LET K = 0
160 LET W = 0
165 RANDOMIZE
170 LET N = INT(1945 * RND(0)) + 1
180 PRINT "ANY TIME YOU WANT TO RESHUFFLE THE CARDS, SIMPLY"
185 PRINT "TYPE 777 WHEN I ASK FOR YOUR WAGER, AND I'LL OBLIGE."
190 PRINT "OK, HERE IS THE FIRST HAND."
200 LET X = INT(10 * RND(0)) + 1
210 DIM D(52), V(5), T(5), W(5)
220 FOR A = 1 TO 52
225 LET D(A) = 0
230 NEXT A
240 DIM Q(52)
245 FOR A = 0 TO 39 STEP 13
250 FOR C = 1 TO 13
255 LET Q(A + C) = C
260 NEXT C
265 NEXT A
270 PRINT
280 LET K = 0
290 FOR P = 1 TO 5
295 LET U(P) = 0
300 LET V(P) = 0
305 LET T(P) = 0
310 NEXT P
315 LET V(3) = 1
320 PRINT
330 PRINT "WAGER?"
340 INPUT W
345 IF W > 500 THEN 360
350 IF W = 777 THEN 380
355 GOSUB 1450
360 PRINT "THAT'S TOO MUCH - HOUSE LIMIT IS $500."
365 GOTO 330
370 PRINT "I SHOW"
375 GOSUB 865
380 IF E(1) = 0 THEN 395
385 LET V(1) = 1
390 LET V(2) = 1
395 GOSUB 865
400 LET M = X
405 LET P = 2
410 PRINT "FIRST CARD IS ";
420 GOSUB 865
430 LET X = M
435 PRINT "NEXT CARD IS ";
440 GOSUB 865
450 IF V(2) = 0 THEN 605
455 LET S = X
460 IF V(3) = 1 THEN 605
465 IF T(P) > 21 THEN 505
470 PRINT "BLACKJACK!"
475 PRINT
480 PRINT "THAT'S GETTING RIDICULOUS!"
485 PRINT
490 PRINT "MY HOLE CARD WAS ";
495 LET X = M
500 GOSUB 1035
505 LET W = W + (2 * W)
510 GOSUB 1335
515 IF V(4) = 0 THEN 570
520 PRINT "INSURANCE ANYONE? (TYPE 1 FOR YES, 0 FOR NO)"
525 INPUT I
530 IF I = 0 THEN 570
535 IF I = 1 THEN 550
540 LET W = W / 2
545 PRINT "YOU WIN $", W / 2, " ON YOUR INSURANCE BET."
550 GOTO 810
555 LET D = D - (W / 2)
560 PRINT "YOU LOST $", W / 2, " ON YOUR INSURANCE BET."
570 IF T(1) <> 21 THEN 805
580 PRINT
585 PRINT "I HAVE BLACKJACK!"
590 LET X = M
595 GOSUB 1035
600 GOTO 1300
605 IF T(P) = 21 THEN 650
610 IF E(P) = 0 THEN 640
615 PRINT "YOU BUSTED."
620 PRINT "YOUR TOTAL IS ", T(P)
625 LET T(P) = T(P) - 10
630 IF T(P) < 21 THEN 775
635 LET E(P) = E(P) - 1
640 IF T(P) > 21 THEN T(P) = T(P) - 10
650 IF V(3) = V(3) + 1 THEN PRINT "INPUT VO"
660 IF V(1) <> 3 THEN 830
670 IF V(2) = 0 THEN 820
680 IF V(3) <> 1 THEN 820
690 IF Q(G) <> Q(S) THEN 700
700 PRINT "NOW IS THAT A PAIR"
710 GOTO 800
715 LET V(2) = 1
720 IF Q(G) = 1 THEN LET V(1) = 2
730 LET P = 1
740 PRINT "PLAY HAND ONE NOW"
750 PRINT "FIRST CARD IS "; LET V(3) = LET X = G
760 GOSUB 710
770 GOTO 431
780 GOSUB 710
790 GOSUB 835
800 LET V(3) = 1
810 LET T(P) = 0
820 RETURN
830 LET P = 2
840 LET V(2) = 0
850 PRINT "PLAY HAND TWO NOW"
860 PRINT "FIRST CARD IS ";
870 LET X = S
880 GOSUB 750
890 IF Q(G) = 1 THEN LET V(1) = 0
900 GOTO 430
910 PRINT "NO SPLITS NOW. TRY AGAIN"
920 GOTO 660
930 IF V(1) <> 2 THEN 905
940 IF V(3) = 2 THEN 850
950 PRINT "TOO LATE TO DOUBLE. CHARGE!"
960 GOTO 660
970 LET W(P) = 2 + W(P)
980 IF V(1) > 0 THEN 430
990 GOTO 620
1000 GOSUB 900
1010 LET T(P) = T(P) + 0
1020 IF V(5) = 0 THEN 890
1030 LET V(5) = 0
1040 RETURN
1050 GOSUB 1035
1060 RETURN
1070 IF RND(1) = 0 THEN 945
1080 LET N = N + 0 + ABS(COS(N * W(1)))
1090 FOR A = 1 TO N
1100 LET X = INT(52.999999 * RND(1))
1110 IF X = 0 THEN 915
1120 NEXT A
1130 IF D(X) = 0 THEN 980
1140 LET R = 1
1150 IF R > 50 THEN 900
1160 FOR A = 1 TO 52
1170 IF D(A) = K THEN 980
1180 LET D(A) = 0
1190 NEXT A
1200 LET R = 0
1210 PRINT "RESHUFFLED"
1220 GOTO 900
1230 LET R = 0
1240 LET D(X) = K
1250 IF Q(X) = 1 THEN 1210
1260 LET C = 1
1270 LET E(P) = E(P) + 1
1280 RETURN
1290 IF Q(X) > 10 THEN 1425
1300 LET C = Q(X)
1310 RETURN
1320 LET C = 0
1330 RETURN
1340 GOSUB 1050
1350 GOSUB 1120
1360 RETURN
1370 IF Q(X) <> 1 THEN 1065
1380 PRINT "ACE"
1390 RETURN
1400 IF Q(X) > 10 THEN 1080
1410 PRINT Q(X); " "
1420 RETURN
1430 IF Q(X) = 11 THEN 1095
1440 PRINT "JACK"
1450 RETURN
1460 IF Q(X) = 12 THEN 1110
1470 PRINT "QUEEN"
1480 RETURN
1490 PRINT "KING"
1500 RETURN
1510 IF X > 39 THEN 1145
1520 IF X > 26 THEN 1155
1530 IF X > 13 THEN 1165
1540 PRINT "OF SPADES"
1550 RETURN
1560 PRINT "OF CLUBS"
1570 RETURN
1580 PRINT "OF HEARTS"
1590 RETURN
1600 PRINT "OF DIAMONDS"
1610 RETURN
1620 END