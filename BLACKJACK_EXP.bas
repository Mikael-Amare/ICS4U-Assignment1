10 PRINT "DO YOU WANT INSTRUCTIONS (IF SO TYPE I)"
15 INPUT K$
20 IF K$ <> "I" THEN GOTO 85
30 PRINT
35 PRINT "THIS IS A GAME OF BLACKJACK. LAS VEGAS STYLE."
40 PRINT "HERE ARE THE RULES OF THE HOUSE. THE DEALER"
45 PRINT "MUST HIT ON 16 OR LESS AND MUST STAY ON 17 OR"
50 PRINT "MORE. YOU MAY SPLIT TWO CARDS IF THEY ARE THE"
55 PRINT "SAME AND PLAY ONE HAND WITH EACH OF THEM. ALSO,"
60 PRINT "YOU MAY DOUBLE YOUR BET AND RECEIVE EXACTLY ONE"
65 PRINT "MORE CARD ANY TIME ON YOUR FIRST HIT."
70 PRINT "THE TYPING INSTRUCTIONS ARE: 0 - NO HIT, 1 - HIT, 2 - DOUBLE, AND"
75 PRINT "3 - SPLIT A PAIR."
80 GOTO 155

100 PRINT "WHEN THE DEALER HAS AN EXPOSED ACE, HE WILL ASK"
105 PRINT "YOU FOR AN INSURANCE BET. AN INSURANCE BET WILL"
110 PRINT "RISK HALF YOUR BET FOR AN AMOUNT EQUAL TO YOUR BET."
115 PRINT "IF YOU WIN, YOU WIN IF THE DEALER HAS A BLACKJACK,"
120 PRINT "AND LOSE IF HE DOESN'T. THE HOUSE LIMIT IS $500.00."
125 PRINT "GOOD LUCK. OH, BY THE WAY, THE DEALER IS NOTED FOR"
130 PRINT "DEALING OFF THE BOTTOM OF THE DECK. WATCH HIM VERY"
135 PRINT "CLOSELY. HERE HE IS NOW."
140 PRINT
150 PRINT
155 RANDOMIZE
160 LET N = INT(1945 * RND(1)) + 1
175 PRINT
180 PRINT "ANY TIME YOU WANT ME TO RESHUFFLE THE CARDS SIMPLY"
185 PRINT "TYPE 777 WHEN I ASK FOR YOUR WAGER AND I'LL BE VERY"
190 PRINT "HAPPY TO OBLIGE. OK, HERE IS THE FIRST HAND."
200 LET X = INT(10 * RND(1)) + 1

' Declare arrays correctly
210 DIM D(52), V(5), T(5), W(5), U(5), E(5)
218 FOR A = 1 TO 52
220   LET D(A) = A
225 NEXT A
238 DIM Q(52)
235 FOR A = 0 TO 39 STEP 13
240   FOR C = 1 TO 13
245     LET Q(A + C) = C
250   NEXT C
255 NEXT A
260 PRINT
265 FOR P = 1 TO 5
270   LET U(P) = 0
280   LET VCP = 0
285   LET TCP = T(P) - 10
290 NEXT P

295 LET V(3) = 1
300 PRINT
305 PRINT
310 PRINT "WAGER"

' W should be a single variable, not an array
320 INPUT W ' Make sure W is declared as a single variable
325 IF W > 500 THEN GOTO 360
330 IF W = 777 THEN GOTO 380
335 GOTO 355
350 GOSUB 145
355 GOTO 315
360 PRINT "THAT'S TOO MUCH - HOUSE LIMIT IS $500"
365 GOTO 315

370 PRINT "I SHOW."
375 GOSUB 865 ' Display dealer's card
385 IF E(1) <> 0 THEN GOTO 395
390 LET V(1) = I ' Current player info
395 LET V(P) = 0 ' Reset player's variable
400 GOSUB 865
405 LET M = X
410 LET P = 2
415 PRINT "FIRST CARD IS "; X
420 GOSUB 865
430 PRINT "NEXT CARD IS "; X
435 GOSUB 865

440 IF V(2) > 0 THEN GOTO 605
445 LET S = X
450 IF V(3) = 1 THEN GOTO 605
455 IF T(P) > 21 THEN GOTO 505
500 PRINT "BLACKJACK!"
465 PRINT
470 PRINT "THAT'S GETTING RIDICULOUS!"
475 PRINT
480 PRINT "MY HOLE CARD IS " + STR$(X)
485 LET X = IM ' Needs clarification
490 GOSUB 1035
495 LET I = 115 ' Assumed player indicator
500 GOSUB 1335
505 IF V(4) > 10 THEN GOTO 570

510 PRINT "INSURANCE ANYONE? TYPE 1 OR 0. 1 MEANS YES"
515 INPUT I
520 PRINT
525 IF I = 1 THEN GOTO 570
530 IF I <> 21 THEN GOTO 550
535 LET W = W(P)
540 PRINT "YOU WIN $" + STR$(W) + " ON YOUR INSURANCE BET"
550 GOTO 810
555 LET W = W(P) / 2
560 PRINT "YOU LOST $" + STR$(W) + " ON YOUR INSURANCE BET - YOU HAVE NO BLACKJACK"
565 IF T(CI) <> 21 THEN GOTO 805
570 PRINT "I HAVE BLACKJACK."
575 PRINT "MY HOLE CARD IS " + STR$(X)
580 GOTO 1300
585 PRINT "YOU HAVE BLACKJACK."
590 LET X = M
595 GOSUB 1035
600 GOTO 1300

605 IF T(P) > 21 THEN GOTO 650
610 IF E(P) > 0 THEN GOTO 640
615 PRINT "YOU TRUSTED,"
620 PRINT "YOUR TOTAL IS " + STR$(TCP)
625 LET C = T(P) - 5 * INT(T(P) / S)
630 GOTO 1175

635 LET E(P) = E(P) - I
640 LET T(P) = T(P) - 10
645 IF V(I) <> 2 THEN GOTO 620
650 LET V(3) = V(3) + 1
655 PRINT "QUIT"
660 INPUT V0
665 IF V(I) <> 3 THEN GOTO 830
670 IF V(2) <> 0 THEN GOTO 820
675 IF V(3) <= 1 THEN GOTO 820
680 IF Q(G) <> Q(S) THEN GOTO 700
685 PRINT "NOW IS THAT A PAIR"
690 GOTO 800

695 LET V(1,2) = 1
700 IF Q(G) = "I" THEN GOTO 115
705 LET V(1,2) = 2
710 PRINT "PLAY HAND ONE NOW"
715 PRINT "FIRST CARD IS "; X
720 GOSUB 710
725 GOTO 431
730 GOSUB 835
735 LET V(3) = 1
740 LET T(P) = C
745 RETURN

750 LET P = 2
755 PRINT "PLAY HAND TWO NOW"
760 PRINT "FIRST CARD IS "; X
765 GOSUB 750
770 IF Q(G) = 1 THEN GOTO 815
775 LET V(1) = 0
780 GOTO 430
785 PRINT "NO SPLITS NOW - TRY AGAIN"
790 GOTO 660
795 IF V(1) = 2 THEN GOTO 845
800 IF V(3) <> 2 THEN GOTO 850
805 PRINT "TOO LATE TO DOUBLE. CHALLENGE."
810 GOTO 660
815 LET W(P) = 2 + W(P)
820 IF V(1) > 0 THEN GOTO 430
825 GOTO 620
830 GOSUB 900
835 LET T(P) = T(P) + C
840 IF V(5) = 0 THEN GOTO 890
845 LET V(5) = 0
850 RETURN
855 GOSUB 1035
860 RETURN

865 IF R = 0 THEN GOTO 945
870 LET N = ABS(COS(N)) + W
875 FOR A = 1 TO N
880 LET X = INT(52.999999 * RND(V)) + 1
885 IF X = 0 THEN GOTO 915
890 NEXT A
895 IF D(X) <> 0 THEN GOTO 980
900 LET HOR = 1
905 IF R = 50 THEN GOTO 900
910 FOR A = 1 TO 52
915 IF D(A) <> K THEN GOTO 980
920 LET D(A) = 0
925 NEXT A
930 LET R = 0
935 PRINT "I RESHUFFLED"
940 GOTO 900
945 LET R = 0
950 LET D(X) = K
955 IF Q(X) = "I" THEN GOTO 1010
960 LET C = Q(X)
965 RETURN
970 IF Q(X) > 10 THEN GOTO 1025
975 LET C = Q(X)
980 RETURN
985 LET C = Q(X)
990 RETURN

995 GOSUB 1050
1000 GOSUB 1120
1005 PRINT "HE TURN"
1010 IF Q(X) <> "I" THEN GOTO 1065
1015 PRINT "ACE " + I$
1020 RETURN
1025 IF Q(X) > 10 THEN GOTO 1080
1030 PRINT Q(X)
1040 RETURN

1050 LET CAU = ? ' Needs clarification
1055 RETURN
1060 GOS
